from tkinter import Tk, Frame, Label, CENTER, BOTH
from tkinter import filedialog, messagebox
from PIL import Image, ImageTk
import datetime
from imutils import face_utils
import dlib
import cv2
import sys
import os
from io import BytesIO
import base64

scr = Tk()

bs64icon="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"

try:
    with open("./address.cfg") as f:
        IP_ADDRESS = f.read().strip()
except FileNotFoundError:
    IP_ADDRESS = "192.168.4.1"

try:
    s = sys.argv[1]
    if s == "-webcam":
        IP_ADDRESS = 0
except:
    pass

icon_data = base64.b64decode(bs64icon)
icon_image = Image.open(BytesIO(icon_data))
icon_photo = ImageTk.PhotoImage(icon_image)
detector = dlib.get_frontal_face_detector()
predictor = dlib.shape_predictor("landmarks68.dat")
vid = cv2.VideoCapture(IP_ADDRESS)
REC_ = False


def _darkTitleBar(self):
    import ctypes as ctp
    self.update()
    DWMA_USE_IMMERSIVE_DARK_MODE = 20 
    windowAttributes = ctp.windll.dwmapi.DwmSetWindowAttribute
    getParent = ctp.windll.user32.GetParent
    hwnd = getParent(self.winfo_id())
    renderingPolicy = DWMA_USE_IMMERSIVE_DARK_MODE
    val = 2
    val = ctp.c_int(val)
    windowAttributes(hwnd, renderingPolicy, ctp.byref(val), ctp.sizeof(val))

def record():
    global FILE, REC_, out
    FILE = f"{datetime.datetime.now().strftime("Record_%d.%m.%Y_%H%M%S.%f")}.mp4"
    REC_ = True

    framewWd = int(vid.get(cv2.CAP_PROP_FRAME_WIDTH))
    framehHt = int(vid.get(cv2.CAP_PROP_FRAME_HEIGHT))
    frameRate = int(vid.get(cv2.CAP_PROP_FPS))

    fourcc = cv2.VideoWriter_fourcc(*"XVID")

    out = cv2.VideoWriter(FILE, fourcc, frameRate, (framewWd, framehHt))

def save_record():
    out.release()
    a = messagebox.askyesno("Record Save", "Do you want to save this record video?")
    if a:
        file = filedialog.asksaveasfilename(defaultextension=".mp4", initialfile=FILE)
        if file:
            import shutil
            shutil.copy2(FILE, file)
            messagebox.showinfo("Record Save", f"Record saved to {file}")
        else:
            messagebox.showinfo("Record Save", f"File not saved!                    ")

def askfor():
    save_record()
    scr.destroy()

scr.title("Fire Robot v1")
scr.geometry("900x600")
scr.resizable(False, False)
scr.iconphoto(False, icon_photo)
frame = Frame(scr, background="black")
text = Label(frame, text="Recording ...", bg="#000000", fg="#ffffff")
text.place(x=0, y=0)
img_frame = Label(frame, background="black")
img_frame.place(anchor=CENTER, relx=.5, rely=.5)
frame.pack(fill=BOTH, expand=True)

def find_bounding_square(points, radius):
    min_x = min(point[0] - radius for point in points)
    max_x = max(point[0] + radius for point in points)
    min_y = min(point[1] - radius for point in points)
    max_y = max(point[1] + radius for point in points)
    square_side = max(max_x - min_x, max_y - min_y)
    bottom_left = (min_x, min_y - 50)
    top_right = (min_x + square_side, min_y + square_side)
    
    return bottom_left, top_right

def open_camera(): 
    global hasMINI
    _, frame = vid.read() 
    gray =  gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)
    rects = detector(gray, 0)
    for (i, rect) in enumerate(rects):
        shape = predictor(gray, rect)
        shape = face_utils.shape_to_np(shape)
        shape = [tuple(x.tolist()) for x in shape]
        t, b = find_bounding_square(shape, 1)
        cv2.rectangle(frame, t, b, (255, 0, 0), 2)
    opencv_image = cv2.cvtColor(frame, cv2.COLOR_BGR2RGBA) 
    if REC_ == True:
        out.write(frame)
    img_h, img_w, channel = opencv_image.shape
    rv = 550 / img_h
    captured_image = Image.fromarray(opencv_image) 
    captured_image = captured_image.resize((int(img_w * rv), int(img_h * rv)))
    photo_image = ImageTk.PhotoImage(image=captured_image) 
    img_frame.photo_image = photo_image 
    img_frame.configure(image=photo_image)
    img_frame.after(10, open_camera) 

open_camera()
record()
scr.protocol("WM_DELETE_WINDOW", askfor)

_darkTitleBar(scr)
scr.mainloop()

os.remove(FILE)